pipeline {
    agent none
    environment {
        NODE_IMAGE = 'node:lts-slim'
        BUILDAH_IMAGE = 'buildah/buildah'
    }
    stages {
        stage('npm install') {

            agent {
                kubernetes {
                    // Load Kubernetes pod YAML from an external file in the repository
                  label 'npm-pod'
                  yamlFile readFile 'agent/buildah-pod.yaml'
                }
            }
            steps {

                container('node') {
                    sh 'npm install --prefix ./app/'
                }
            }
        }
       
    }
}
